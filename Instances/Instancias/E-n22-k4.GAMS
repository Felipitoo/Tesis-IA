SET
I NODO TIPO I /I0*I21/
K TIPO DE VEHICULO K /K1*K4/;
ALIAS (I,J,F);
SCALAR N CANTIDAD DE NODOS /22/;
SCALAR M NUMERO DE VEHICULOS /4/;
PARAMETERS
CP(K) CAPACIDAD DEL VEHICULO K
/
K1	6000
K2	6000
K3	6000
K4	6000
/
O(J) OFERTA DEL PRODUCTO EN LA UNIDAD PRODUCTIVA DEL AGRICULTOR J
/
I0	0
I1	1100
I2	700
I3	800
I4	1400
I5	2100
I6	400
I7	800
I8	100
I9	500
I10	600
I11	1200
I12	1300
I13	1300
I14	300
I15	900
I16	2100
I17	1000
I18	900
I19	2500
I20	1800
I21	700
/
;
TABLE C(I,J) COSTO ASOCIADO A LAS CARACTERISTICAS DE LA RUTA ENTRE EL NODO I AL NODO J
	I0	I1	I2	I3	I4	I5	I6	I7	I8	I9	I10	I11	I12	I13	I14	I15	I16	I17	I18	I19	I20	I21	
I0	0	22	11	9	12	10051	9	9	8666	7	6	6422	3	7	2	7	10	7944	8	6661	10	11915	
I1	22	0	2234	8305	6980	5584	6	7	9388	17	18	9	19	24	25	32	16	18	64	31	22	18208	
I2	11	2234	0	6439	23	3	17	27	7539	10	6883	12006	16	15	17	19137	20581	19	15	21778	34	22616	
I3	9	8305	6439	0	444	15	4	15	9	11	13	6	50	8882	12	21	13681	22748	31	18149	82	20	
I4	12	6980	23	444	0	9772	6	14	4219	13721	8	23	15887	17	16971	15636	13123	17032	24914	20	52	78	
I5	10051	5584	3	15	9772	0	7	1	12	3	15	17	12	13	12	9	18	50	48	15	45	24914	
I6	9	6	17	4	6	7	0	7	2	6860	6	5	8	8	13721	9	14	14798	15	66	14	14	
I7	9	7	27	15	14	1	7	0	7	3	5	9493	7	47	8216	12	36	13960	44	13545	41	18	
I8	8666	9388	7539	9	4219	12	2	7	0	5863	2	14	8	7818	17	17	7	12844	44	14240	12213	14	
I9	7	17	10	11	13721	3	6860	3	5863	0	4	9772	5	9	14	7818	13	18	15	84	18	16473	
I10	6	18	6883	13	8	15	6	5	2	4	0	6	7	12	7	31	9	14	12	16971	13123	13960	
I11	6422	9	12006	6	23	17	5	9493	14	9772	6	0	35	4747	32	9	13	9326	38	15	77	11	
I12	3	19	16	50	15887	12	8	7	8	5	7	35	0	12	3630	4	6499	9	36	11	7106	13721	
I13	7	24	15	8882	17	13	8	47	7818	9	12	4747	12	0	7	25	5055	24	12	9027	42	10	
I14	2	25	17	12	16971	12	13721	8216	17	14	7	32	3630	7	0	6	2	3331	33	22	8	10	
I15	7	32	19137	21	15636	9	9	12	17	7818	31	9	4	25	6	0	5	6143	4	10	10	9	
I16	10	16	20581	13681	13123	18	14	36	7	13	9	13	6499	5055	2	5	0	20	10	7222	6	8666	
I17	7944	18	19	22748	17032	50	14798	13960	12844	18	14	9326	9	24	3331	6143	20	0	8	5	2	2887	
I18	8	64	15	31	24914	48	15	44	44	15	12	38	36	12	33	4	10	8	0	13	4	6	
I19	6661	31	21778	18149	20	15	66	13545	14240	84	16971	15	11	9027	22	10	7222	5	13	0	5773	4	
I20	10	22	34	82	52	45	14	41	12213	18	13123	77	7106	42	8	10	6	2	4	5773	0	5777	
I21	11915	18208	22616	20	78	24914	14	18	14	16473	13960	11	13721	10	10	9	8666	2887	6	4	5777	0	

;
TABLE CTO(I,J) COSTO DE OPERACION VEHICULAR DE LA RUTA ENTRE EL NODO I AL NODO J
	I0	I1	I2	I3	I4	I5	I6	I7	I8	I9	I10	I11	I12	I13	I14	I15	I16	I17	I18	I19	I20	I21	
I0	0	47	50	49	45	44	43	43	42	43	45	42	40	41	43	45	39	42	43	43	43	44	
I1	47	0	39	42	42	41	41	42	42	43	44	49	46	47	48	48	48	51	51	52	56	53	
I2	50	39	0	43	44	40	41	41	43	42	43	46	49	48	47	47	48	54	54	52	51	52	
I3	49	42	43	0	38	44	45	44	41	44	43	46	46	45	46	52	47	49	50	49	51	51	
I4	45	42	44	38	0	44	41	44	41	45	43	42	46	45	46	48	46	49	50	49	51	50	
I5	44	41	40	44	44	0	41	42	42	44	42	45	43	50	49	49	46	48	47	54	49	50	
I6	43	41	41	45	41	41	0	40	39	41	40	46	47	48	45	49	45	47	51	48	53	53	
I7	43	42	41	44	44	42	40	0	45	39	41	44	42	45	44	48	45	47	47	49	48	53	
I8	42	42	43	41	41	42	39	45	0	42	39	41	42	43	43	45	48	46	47	47	48	48	
I9	43	43	42	44	45	44	41	39	42	0	44	44	41	49	44	43	48	46	46	48	47	48	
I10	45	44	43	43	43	42	40	41	39	44	0	41	41	42	46	43	42	45	49	46	46	47	
I11	42	49	46	46	42	45	46	44	41	44	41	0	43	41	43	49	43	45	47	45	47	51	
I12	40	46	49	46	46	43	47	42	42	41	41	43	0	43	40	40	41	42	42	48	44	45	
I13	41	47	48	45	45	50	48	45	43	49	42	41	43	0	41	44	40	43	45	42	45	44	
I14	43	48	47	46	46	49	45	44	43	44	46	43	40	41	0	45	42	40	42	42	42	42	
I15	45	48	47	52	48	49	49	48	45	43	43	49	40	44	45	0	46	42	44	45	42	44	
I16	39	48	48	47	46	46	45	45	48	48	42	43	41	40	42	46	0	40	42	41	46	42	
I17	42	51	54	49	49	48	47	47	46	46	45	45	42	43	40	42	40	0	41	45	44	40	
I18	43	51	54	50	50	47	51	47	47	46	49	47	42	45	42	44	42	41	0	48	44	46	
I19	43	52	52	49	49	54	48	49	47	48	46	45	48	42	42	45	41	45	48	0	42	44	
I20	43	56	51	51	51	49	53	48	48	47	46	47	44	45	42	42	46	44	44	42	0	41	
I21	44	53	52	51	50	50	53	53	48	48	47	51	45	44	42	44	42	40	46	44	41	0	

;
VARIABLES
Z	 COSTO TOTAL DE TRANSPORTE
X(I,J,K)	 1 SI SE ASIGNA EL VEHICULO K PARA VIAJAR DESDE EL NODO I AL NODO J
Y(J,K)	 1 SE SE ASIGNA EL NODO I PARA SER ATENDIDO POR EL VEHICULO K
U(I,K)	 VARIABLE QUE ELIMINA LOS SUBTOURS
;
BINARY VARIABLE
X(I,J,K), Y(J,K);
POSITIVE VARIABLE
U(I,K);
EQUATIONS
FO	 FUNCION OBJETIVO PARA MINIMIZAR LOS COSTOS DE TRANSPORTE
R1(J,K)	 ASEGURA QUE UN VEHICULO LLEGUE AL NODO J DESPUES DE VISITAR EL NODO INMEDIATAMENTE ANTERIOR
R2(I,K)	 ASEGURA QUE UN VEHICULO ABANDONE EL NODO I
R3	 ASEGURA QUE EL VEHICULO INICIE EN EL CENTRO DE ACOPIO Y FINALICE EN EL MISMO LUGAR
R4(F,K)	 ASEGURA QUE EL VEHICULO QUE LLEGUE AL NODO J DEBE ABANDONARLO PARA SATISFACER LA CONDICION DE CONTINUIDAD AL MODELO
R5(J,K)	 ASIGNA EL NODO J AL VEHICULO K QUE PASA POR ESE NODO
R6(J)	 ASEGURA QUE CADA AGRICULTOR SEA ASIGNADO A UNA RUTA
R7(K)	 ASEGURA QUE EL VEHICULO NO EXCEDA SU CAPACIDAD
R8(I,J,K)	 ASEGURA LA ELIMINACION DE SUBTOURS
R9(J,K)	 ASEGURA LA ELIMINACION DE SUBTOURS
R91(J,K)	 ASEGURA LA ELIMINACION DE SUBTOURS
;
FO..	 Z=E=SUM((I,J,K)$(NOT SAMEAS(I,J)),C(I,J)*X(I,J,K))+SUM((I,J,K)$(NOT SAMEAS(I,J)),CTO(I,J)*X(I,J,K));
R1(J,K)$(ORD(J)>1)..	 SUM((I)$(NOT SAMEAS(I,J)),X(I,J,K))=L=1;
R2(I,K)$(ORD(I)>1)..	 SUM((J)$(NOT SAMEAS(I,J)),X(I,J,K))=L=1;
R3..	 SUM((K,J)$(NOT SAMEAS(K,J)),X("I0",J,K))=E=M;
R4(F,K)..	 SUM((I)$(NOT SAMEAS(I,F)),X(I,F,K))=E=SUM((J)$(NOT SAMEAS(J,F)),X(F,J,K));
R5(J,K)$(ORD(J)>1)..	 SUM((I)$(NOT SAMEAS(I,J)),X(I,J,K))=E=Y(J,K);
R6(J)$(ORD(J)>1)..	 SUM((K),Y(J,K))=E=1;
R7(K)..	 SUM((J),O(J)*Y(J,K))=L=CP(K);
R8(I,J,K)$(ORD(I)>1 AND ORD(J)>1 AND NOT SAMEAS(I,J))..	 U(I,K)-U(J,K)+CP(K)*X(I,J,K)=L=CP(K)-O(J);
R9(J,K)$(ORD(J)>1)..	 U(J,K)=G=O(J);
R91(J,K)$(ORD(J)>1)..	 U(J,K)=L=CP(K);
MODEL MODELO_ARTICULO_CVRP /ALL/;
SOLVE MODELO_ARTICULO_CVRP USING MIP MINIMIZING Z;
DISPLAY X.L,Y.L,Z.L;
